\فصل{مقدمه}

تخمین مدت زمان سفر مسئله‌ی پرکاربردی برای بسیاری از سازمان‌ها است. یکی از کلیدی ترین مراحل تخمین زمان سفر پیش‌بینی ترافیک است این موضوع به خصوص در سفرهای طولانی بسیار پراهمیت است. پیش از این کارهای متعددی در راستای حل این مسئله انجام شده است. از این کارها می‌توان به روش‌های آماری مانند رگراسیون خطی اشاره کرد که در سفرهای کوتاه مدت عملکرد خوبی دارند اما با طولانی‌تر شدن زمان سفر عملکردشان افت می‌کند. در سفرهای طولانی از روش‌هایی مانند مدل کردن پویا و روش‌های داده محور استفاده می‌شود. امروزه با توجه به داده‌های زیادی که در اختیار داریم علاقه به سمت روش‌های داده محور مانند مدل‌های آماری کلاسیک و مدل‌های یادگیری ماشین  بیشتر است. در این گزارش ما نیز یک مدل یادگیری ماشین با رویکرد یادگیری عمیق را بحث خواهیم کرد و مورد ارزیابی قرار خواهیم داد. پیشتر از شبکه‌های عمیق مانند شبکه‌ی باور عمیق و کدکننده‌ی خودکار پشته‌ای برای پیش‌بینی ترافیک استفاده شده است اما این شبکه‌ها نمی‌توانند ویژگی‌های زمانی و مکانی را به طور مشترک از ورودی استخراج کنند.

مسئله بدین شکل است که می‌خواهیم برای تعدادی مختصات مشخص که به عنوان ورودی داده می‌شوند سرعت ترافیک را در گام‌های زمانی آینده پیش‌بینی کنیم و برای این کار از سرعت ترافیک در این مختصات‌ها در گام‌های زمانی گذشته استفاده می‌کنیم. برای این پیش‌بینی از هر دو نوع ویژگی زمانی و مکانی بهره می‌بریم. با توجه به فاصله‌ی مختصات‌های مشخص شده از هم می‌توانیم گرافی رسم کنیم که گره‌های آن مختصات‌ها هستند و وزن یال‌ها با عکس فاصله‌ی مختصات‌ها از هم رابطه‌ی مستقیم دارد سپس برای آنکه بتوانیم از اطلاعات مکانی حداکثر بهره را ببریم مستقیما بر روی این گراف پیچش اعمال می‌کنیم. بدیهی است تغییر سرعت ترافیک در یک گره گراف باعث تغییر سرعت ترافیک در گره‌های مجاور می‌شود که میزان این تاثیر بر حسب فاصله‌ی گره‌ها از هم متفاوت است

در روش پیشنهادی سعی بر این است تا از هر دو ویژگی‌های زمانی و مکانی برای پیش‌بینی بهره بگیریم به همین جهت مدل، هر دو لایه‌های پیچشی زمانی و پیچشی مکانی را در خود دارد یکی از مسائل قابل توجه این است که در این روش از پیچش مستقیم بر روی گراف استفاده می‌شود که با پیچش استاندارد که بر تصاویر اعمال می‌شود، متفاوت است. پیچیدگی زمانی پیچش بر روی گراف $O(n^{2})$ است برای سبک‌تر شدن حجم محاسبات می‌توانیم از تخمین مرتبه اول و یا تخمین چبیشف استفاده کنیم که در این گزارش ما از تخمین چبیشف کمک می‌گیریم.

مسئله‌ای که با آن رو به رو هستیم جزء مسائل سری زمانی طبقه‌بندی می‌شود در چنین مسائلی شبکه‌های عصبی بازرخدادی پرکاربرد اند اما این شبکه‌ها دیر به تغییرات پاسخ می‌دهند به همین دلیل ما از ساختارهای کاملا پیچشی بر روی محور زمان استفاده می‌کنیم تا بتوانیم رفتار پویای سرعت ترافیک را دنبال کنیم.

از آن جایی که قصد داریم سرعت ترافیک را در چند گام زمانی (نه لزوما یک) آینده پیش‌بینی کنیم باید روشی برای آن اتخاذ کنیم. برای پیش‌بینی سرعت ترافیک یک گام زمانی آینده از تعدادی سرعت گذشته که در مجموعه داده در اختیار داریم، استفاده می‌کنیم، پنجره‌ای به اندازه‌ی تعداد این سرعت‌ها داریم، پس از پیش‌بینی سرعت برای یک گام آینده این پنجره را یک واحد به سمت جلو می‌بریم. با این کار پیش‌بینی ما برای یک گام آینده داخل پنجره قرار می‌گیرد و در حقیقت از پیش‌بینی که برای یک گام زمانی بعد انجام داده بودیم برای پیش‌بینی سرعت در دو گام زمانی بعد استفاده می‌کنیم. این کار را برای هرچند گام زمانی می‌توانیم تکرار کنیم

برای ارزیابی روش پیشنهادی از دو مجموعه داده‌ی \متن‌لاتین{PeMSD7} و اسنپ! استفاده می‌کنیم. مجموعه‌داده‌ی \متن‌لاتین{PeMSD7} به صورت تمیز شده در اکوسیستم متن باز وجود دارد
اما در مجموعه داده‌ی اسنپ! باید با استفاده از مختصات‌های جغرافیایی، که توسط موقعیت‌یاب‌های
جهانی تلفن‌های همراه رانندگان جمع‌آوری شده است، سرعت خیابان‌ها را محاسبه کنیم.
سپس از این سرعت‌ها برای آموزش مدل استفاده کنیم که نتایج مدل بر روی هر دو مجموعه داده رضایت بخش است.

\قسمت{تعریف مساله}

برای درک بهتر مسئله همزمان با توضیح آن یک مثال را به طور موازی پیش می‌بریم.
هدف از این رساله بیان راه‌حلی برای پیش‌بینی سرعت ترافیک در برخی خیابان‌ها در چند گام زمانی آینده است. خیابان‌ها و تقاطع آن‌ها را می توان به مانند یک گراف مدل کرد و با شروع از گره مبدا و پیمایش یال‌های این گراف به گره مقصد رسید سپس با استفاده از سرعت خیابان‌ها که پیش‌بینی آن‌ها هدف اصلی این پروژه است و طول آن‌ها که در داده‌های نقشه‌ها وجود دارد زمان سفر را تخمین زد. به این روش برای تخمین سفر مبتنی بر قطعه خیابان \پانویس{\متن‌لاتین{segment-based}} گفته می‌شود در بسیاری از روش‌ها برای جلوگیری از واریانس بالای سرعت رانندگان مختلف در یک خیابان از روش مبتنی بر مسیر \پانویس{\متن‌لاتین{path-based}} استفاده می‌شود.

\زیرقسمت{زمان سفر مبتنی بر بخش جاده}
رویکردها با استفاده از مدار آشکارساز \پانویس{\متن‌لاتین{loop detector}}: تعیین سرعت ترافیک بر اساس مدارهای آشکارساز نصب شده در هر دو نقطه پایانی یک بخش جاده، در چند دهه گذشته به شدت مورد مطالعه قرار گرفته است. هنگام عبور خودرو، فاصله‌ی زمانی عبور از دو مدار آشکارساز مجاور ثبت می شود که بر اساس آن سرعت خودرو محاسبه می شود. از آنجایی که بسیاری از جاده‌ها مدار آشکارساز مدفون ندارند، این دسته از تحقیقات عمدتاً بر همان بخش‌های جاده‌ای تکی و محدود تمرکز می‌کنند، و بنابراین مقیاس‌پذیری آن‌ها تا کل شهر دشوار است.


رویکردهای داده‌های شناور: یادگیری حمل‌ونقل شهری با استفاده از داده‌های شناور خودروها اخیراً توجه بیشتری را به خود جلب کرده است. در این رویکردها، خودروهایی که در یک شهر رانده می‌شوند به عنوان حسگرهای پویا برای بررسی شرایط ترافیکی عمل می‌کنند و \متن‌لاتین{GPS}های آنها برای محاسبه سرعت و زمان سفر در بخش‌های جاده استفاده می‌شود. اکثر روش‌ها زمان سفر یک بخش جاده را بدون در نظر گرفتن همبستگی بین شرایط ترافیکی در جاده‌های مختلف استنباط می‌کنند. این امر دقت استنباط را در محیط شهری که شرایط ترافیکی به هم مرتبط است کاهش می دهد. برخی از مدل های دیگر سرعت سفر یک بخش جاده را با در نظر گرفتن الگوهای ترافیکی سایر بخش های جاده متصل به آن پیش بینی می کنند. متأسفانه، هنگامی که مقیاس آن به کل شهر می رسد، این روش ها اغلب منجر به مدلی با پیچیدگی‌های بالا می‌شوند. علاوه بر این، آنها مشکل تنک بودن داده‌ها را حل نمی‌کنند، به عنوان مثال، بسیاری از بخش های جاده توسط رانندگان در گام زمانی فعلی پیموده نمی‌شوند، که در واقعیت بسیار رایج است. الگوهای ترافیکی بخش های مجاور را می توان به عنوان همبستگی محلی بین بخش های جاده در نظر گرفت. با این حال، همبستگی بین بخش‌های جاده‌ای که از نظر جغرافیایی به هم متصل نیستند در این حالت‌ها در نظر گرفته نمی‌شود. همانطور که قبلاً ذکر کردیم، مدل‌سازی صریح عوامل پیچیده برای عبور از دو بخش جاده، به عنوان مثال، تقاطع‌ها، پیچ‌ها و چراغ‌های راهنمایی دشوار است
\مرجع{10.1145/2623330.2623656}.

\زیرقسمت{زمان سفر مبتنی بر مسیر}
یک رویکرد ممکن برای مقابله با ضعف روش‌های مبتنی بر بخش جاده، تخمین زمان سفر یک مسیر به طور کلی بر اساس الگوهای مسیر مکرر است. برای مثال، می‌توانیم الگوهای مکرر را از قبل از مسیرهای تاریخی استخراج کنیم، و سپس از میانگین زمان سفر یک الگو برای نشان دادن زمان سفر بر روی مسیر متناظر با آن الگو استفاده کنیم. همچنین می توان برخی مدل‌ها را بر اساس داده‌های تاریخی یک مسیر ساخت تا زمان سفر آینده مسیر را تخمین بزند. این رویکرد به تعادلی بین پوشش پرسش‌هایی که می‌تواند پاسخ دهد و دقت زمان سفر استنباط‌شده نیاز دارد. برای اینکه بتوان به مسیرهای مختلف پرس و جو پاسخ داد، این روش ها باید الگوهای مسیر بیشتری را با استفاده از یک پشتیبانی \پانویس{support} کوچک انتخاب کنند. با این حال، زمان سفر به دست آمده از یک پشتیبانی کوچک دقیق نیست. علاوه بر این، زمان سفر یک مسیر در بازه زمانی فعلی ممکن است بسته به شرایط ترافیک در زمان واقعی، به طور قابل توجهی از میانگین تاریخی آن انحراف داشته باشد. علاوه بر این، بسیاری از مسیرهای پرس و جو ممکن است با هیچ مسیری در گام زمانی فعلی و همچنین در تاریخ مطابقت نکنند. تحقیقات اخیر شروع به یافتن الحاق بهتر بخش‌های جاده برای تخمین زمان سفر یک مسیر کرده‌اند. مجموعه‌ای از تحقیقات تلاش می‌کنند تا زمان صرف شده در تقاطع‌ها را به صراحت محاسبه کنند. این می تواند به جمع بندی دقیق‌تری از زمان سفر هر بخش جاده منجر شود
\مرجع{10.1145/2623330.2623656}.

در این پروژه ما از روش مبتنی بر بخش جاده استفاده می‌کنیم و قصد داریم سرعت ترافیک را در بخش جاده‌ها در گام‌های زمانی آینده پیش‌بینی می‌کنیم.

رابطه (\رجوع{eq:base}) این مساله سری زمانی را به زبان ریاضی توصیف می‌کند.

\begin{equation}
  \label{eq:base}
  \hat{v}_{t+1}, \ldots,  \hat{v}_{t+H} = \mathop{\mathrm{argmax}} \log \mathsf{P}({v}_{t+1}, \ldots,  v_{t+H} | v_{t-M+1} , \ldots,  v_{t})
\end{equation}

\begin{table}[h]
  \centering
  \caption{توضیح پارامترهای رابطه (\رجوع{eq:base})}
  \begin{tabular}{|c|p{0.5\textwidth}|}
    \hline
    $v_{t}$ & یک بردار به طول تعداد نقاطی که قصد داریم سرعت ترافیک را در آن‌ها پیش‌بینی کنیم که هر المان شامل سرعت ترافیک در یکی از مختصات‌های مورد نظر در زمان $t$ است. \\
    \hline
    $\hat{v}_{t+1}$ & سرعت پیش‌بینی شده در زمان $t+1$ \\
    \hline
    $H$ & تعداد گام های زمانی آینده که می‌خواهیم سرعت ترافیک را پیش بینی کنیم. \\
    \hline
    $M$ & تعداد گام های زمانی پیشین که برای پیش بینی استفاده می‌کنیم. \\
    \hline
  \end{tabular}
  \label{tbl:base}
\end{table}

در این کار، شبکه‌ی ترافیک را بر روی یک گراف تعریف می کنیم و بر سری‌های زمانی ترافیکی ساختاریافته تمرکز می کنیم. مشاهده‌ی $v_{t}$ مستقل نیست و با سایر سرعت‌های مشاهده شده مرتبط است. بنابراین، نقطه داده‌ی $v_{t}$ را می توان به عنوان یک سیگنال گراف در نظر گرفت که بر روی یک گراف بدون جهت (یا جهت دار) $G$ با وزن‌های $w_{ij}$ تعریف می‌شود. در مرحله \متن‌لاتین{t}-امین، در گراف $G_{t} = (V_{t}, \varepsilon , W)$,  $V_{t}$ مجموعه‌ی محدودی از رئوس است که مربوط به مشاهدات در یک شبکه ترافیک است. $\varepsilon$ مجموعه ای از یال‌ها است که ارتباط بین رئوس را نشان می دهد. در این حال $W ∈ R n×n$ نشان دهنده ماتریس مجاورت وزنی گراف $G_{t}$ است.

برای مثال فرض کنیم می‌خواهیم سرعت ترافیک را در میدان فاطمی و میدان فلسطین (دو میدان معروف در تهران) پیش‌بینی کنیم.
$v_{t}$ یک بردار به طول دو خواهد بود که یک عضو آن سرعت ترافیک در میدان فاطمی در زمان $t$ مانند ساعت دو بعد از ظهر امروز و عضو دیگر آن شامل همین اطلاعات برای میدان فلسطین خواهد بود.
در این مثال $H$ را برابر یک و $M$ را برابر سه در نظر می‌گیریم. منظور از \رجوع{eq:base} این است که قصد داریم سرعت ترافیک در $H$ قدم زمانی بعدی را با دانستن $M$ قدم زمانی قبلی پیش‌بینی کنیم.
